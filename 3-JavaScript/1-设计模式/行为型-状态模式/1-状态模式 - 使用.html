<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>
	<button id="changeMy" onclick="changeState('my')">changeMy</button>
	<button id="changeMd" onclick="changeState('md')">changeMd</button>
	<button id="changeHtml" onclick="changeState('html')">changeHtml</button>
	</br></br>
	<button id="initdata" onclick="initdata()">initdata</button>
	<button id="savedata" onclick="savedata()">savedata</button>
</body>

<script type="text/javascript">

	var state = "";

	var myState = new MyState();
	var htmlState = {};
	var mdState = {};

	var currentState = myState;
	
/*	if (1==1){

		state = "my";

		changeState(state);

		initdata("my.my");

	} */

	function initdata(path){
		var editContext = new EditContext();
        editContext.change(currentState);
        editContext.initdata(path);
	}

	function savedata(){
		var editContext = new EditContext();
        editContext.change(currentState);
        editContext.savedata();
	}
/*
	function test(){
		var editContext = new EditContext();
        editContext.change(currentState);
        editContext.test();
	}

	window.onload = function(){
		var editContext = new EditContext();
        editContext.change(currentState);
        editContext.onload();
	}

	window.onresize = function(){
		var editContext = new EditContext();
        editContext.change(currentState);
        editContext.onresize();
	}
*/

    //状态切换函数，用于切换页面变量'currentState',页面上的状态判断都是以此为基础。
	function changeState(state){
		switch(state){
			case "my": currentState = myState;  break;
			case "md": currentState = mdState;  break;
			case "html": currentState = htmlState;  break;
			default: currentState = myState;
		}
	}

	//定义一个全局变量context，他包含了状态信息，并根据状态做出不同行为。
	function EditContext(){	}
	EditContext.prototype = {
		constructor:EditContext,
		editContext:null,
		change: function (context) {
	        editContext = context;
	    },
		onload: function () {
			editContext.onload();
		},
		onresize: function () {
			editContext.onresize();
		},
		test: function () {
			editContext.test();
		},
		savedata: function () {
			editContext.savedata();
		},
		initdata: function () {
			editContext.initdata();
		}
	}

    //定义了一个状态类，包含了处理'my'类型的文件的所有操作。
    function MyState() { }
    MyState.prototype.onload = function()
	    {
			alert("onload");
	    };
		
		//窗口改变时候，改变编辑区 
		MyState.prototype.onresize = function () {
			alert("onresize");
		};
	    
	    MyState.prototype.test =function test() {  
	        alert("test");
	    }  
	    
	    MyState.prototype.savedata = function savedata(){
	    	alert("savedata");
	    }
	    
	    MyState.prototype.initdata = function initdata(path){
	    	alert(path);
	    }

</script>

</html>