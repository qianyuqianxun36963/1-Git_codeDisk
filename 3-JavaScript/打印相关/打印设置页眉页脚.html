<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>
	<button onclick="UserPrint('null')">打印-去掉页眉页脚</button>
	<button onclick="UserPrint('default')">打印-默认页眉页脚</button>
	<ul>
		<li class="item1">item 01this is data </li>
		<li class="item2">item 02this is data </li>
		<li class="item3">item 03this is data </li>
		<li class="item4">item 04this is data </li>
		<li class="item5">item 05this is data </li>
		<li class="item6">item 06this is data </li>
		<li class="item7">item 07this is data </li>
		<li class="item8">item 08this is data </li>
		<li class="item9">item 09this is data </li>
		<li class="item10">item 10this is data </li>
		<li class="item11">item 11this is data </li>
		<li class="item12">item 12this is data </li>
		<li class="item13">item 13this is data </li>
		<li class="item14">item 14this is data </li>
		<li class="item15">item 15this is data </li>
		<li class="item16">item 16this is data </li>
		<li class="item17">item 17this is data </li>
		<li class="item18">item 18this is data </li>
		<li class="item19">item 19this is data </li>
		<li class="item20">item 20this is data </li>
		<li class="item21">item 21this is data </li>
		<li class="item22">item 22this is data </li>
		<li class="item23">item 23this is data </li>
		<li class="item24">item 24this is data </li>
		<li class="item25">item 25this is data </li>
		<li class="item26">item 26this is data </li>
		<li class="item27">item 27this is data </li>
		<li class="item28">item 28this is data </li>
		<li class="item29">item 29this is data </li>
		<li class="item30">item 30this is data </li>
		<li class="item31">item 31this is data </li>
		<li class="item32">item 32this is data </li>
		<li class="item33">item 33this is data </li>
		<li class="item34">item 34this is data </li>
		<li class="item35">item 35this is data </li>
		<li class="item36">item 36this is data </li>
		<li class="item37">item 37this is data </li>
		<li class="item38">item 38this is data </li>
		<li class="item39">item 39this is data </li>
		<li class="item40">item 40this is data </li>
		<li class="item41">item 41this is data </li>
		<li class="item42">item 42this is data </li>
		<li class="item43">item 43this is data </li>
		<li class="item44">item 44this is data </li>
		<li class="item45">item 45this is data </li>
		<li class="item46">item 46this is data </li>
		<li class="item47">item 47this is data </li>
		<li class="item48">item 48this is data </li>
		<li class="item49">item 49this is data </li>
		<li class="item50">item 50this is data </li>
		<li class="item51">item 51this is data </li>
		<li class="item52">item 52this is data </li>
		<li class="item53">item 53this is data </li>
		<li class="item54">item 54this is data </li>
		<li class="item55">item 55this is data </li>
		<li class="item56">item 56this is data </li>
		<li class="item57">item 57this is data </li>
		<li class="item58">item 58this is data </li>
		<li class="item59">item 59this is data </li>
		<li class="item60">item 60this is data </li>
		<li class="item61">item 61this is data </li>
		<li class="item62">item 62this is data </li>
		<li class="item63">item 63this is data </li>
		<li class="item64">item 64this is data </li>
		<li class="item65">item 65this is data </li>
		<li class="item66">item 66this is data </li>
		<li class="item67">item 67this is data </li>
		<li class="item68">item 68this is data </li>
		<li class="item69">item 69this is data </li>
		<li class="item70">item 70this is data </li>
		<li class="item71">item 71this is data </li>
		<li class="item72">item 72this is data </li>
		<li class="item73">item 73this is data </li>
		<li class="item74">item 74this is data </li>
		<li class="item75">item 75this is data </li>
		<li class="item76">item 76this is data </li>
		<li class="item77">item 77this is data </li>
		<li class="item78">item 78this is data </li>
		<li class="item79">item 79this is data </li>
		<li class="item80">item 80this is data </li>
		<li class="item81">item 81this is data </li>
		<li class="item82">item 82this is data </li>
		<li class="item83">item 83this is data </li>
		<li class="item84">item 84this is data </li>
		<li class="item85">item 85this is data </li>
		<li class="item86">item 86this is data </li>
		<li class="item87">item 87this is data </li>
		<li class="item88">item 88this is data </li>
		<li class="item89">item 89this is data </li>
		<li class="item90">item 90this is data </li>
		<li class="item91">item 91this is data </li>
		<li class="item92">item 92this is data </li>
		<li class="item93">item 93this is data </li>
		<li class="item94">item 94this is data </li>
		<li class="item95">item 95this is data </li>
		<li class="item96">item 96this is data </li>
		<li class="item97">item 97this is data </li>
		<li class="item98">item 98this is data </li>
		<li class="item99">item 99this is data </li>
		<li class="item100">item 100this is data </li>
	</ul>
</body>


<script language="javascript" type="text/javascript">
        function UserPrint(flag)
        {   
        	debugger;
        	if(flag == 'null'){
        		pagesetup_null(); 
        	}else{
        		pagesetup_default();
        	}
        	window.print();  
        }               
        //设置网页打印的页眉页脚为空 
		function pagesetup_null(){ 
			var hkey_root,hkey_path,hkey_key 
		    hkey_root="HKEY_CURRENT_USER" 
		    hkey_path="\\Software\\Microsoft\\Internet Explorer\\PageSetup\\" 
		    try{ 
		        var RegWsh = new ActiveXObject("WScript.Shell") 
		        hkey_key="header" 
		        RegWsh.RegWrite(hkey_root+hkey_path+hkey_key,"") 
		        hkey_key="footer" 
		        RegWsh.RegWrite(hkey_root+hkey_path+hkey_key,"") 
		    }catch(e){} 
		}

        //设置网页打印的页眉页脚为默认值 
        function pagesetup_default(){ 
        	var hkey_root,hkey_path,hkey_key 
            hkey_root="HKEY_CURRENT_USER" 
            hkey_path="\\Software\\Microsoft\\Internet Explorer\\PageSetup\\" 
            try{ 
                var RegWsh = new ActiveXObject("WScript.Shell") 
                hkey_key="header" 
                RegWsh.RegWrite(hkey_root+hkey_path+hkey_key,"&w&b页码,&p/&P") 
                hkey_key="footer" 
                RegWsh.RegWrite(hkey_root+hkey_path+hkey_key,"&u&b&d") 
            }catch(e){} 
        } 
    </script>

</html>