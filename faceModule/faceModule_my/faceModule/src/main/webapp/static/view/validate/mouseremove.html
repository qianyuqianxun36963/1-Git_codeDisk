<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <!--<link rel="stylesheet" href="static/css/lib/bootstrap/bootstrap.min.css">-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">

    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="static/js/lib/jquery/jquery.min.js"></script>
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="static/js/lib/bootstrap/bootstrap.min.js"></script>

    <!--引入js文件-->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
    <!--html5Validata验证的包-->
    <script src="static/js/lib/html5Validate/jquery-html5Validate.js"></script>

    <style>
        /*表单认证错误样式*/
        .error {
            box-shadow: 0 0 10px #ff4136 !important;
        }
    </style>

</head>
<body>

<div class="container-fluid">
    <div class="row-fluid">
        <div class="span4">
            <form id="form11">
                <fieldset>
                    <legend>表单项</legend>
                    <label for="email">邮箱：</label><input id="email" name="email" placeholder="请输入邮箱" type="email" required/>
                    <label for="phone">手机：</label><input id="phone" name="phone" placeholder="请输入手机" type="phone" required />
                    <label for="tel">电话：</label><input id="tel" name="tel" placeholder="请输入邮箱" type="tel"  />
                    <button type="submit" class="btn">submit</button>
                </fieldset>
            </form>
        </div>
        <div class="span4">
            <form  id="form12">
                <fieldset>
                    <legend>表单项</legend>
                    <label for="qq">QQ：</label><input id="qq" name="qq" placeholder="请输入QQ" type="qq"  />
                    <label for="nickname">昵称：</label><input id="nickname" name="nickname" placeholder="请输入昵称" type="nickname" />
                    <button type="submit" class="btn">submit</button>
                </fieldset>
            </form>
        </div>
        <div class="span4">
            <form  id="form13">
                <fieldset>
                    <legend>表单项</legend> <label>表签名</label><input type="text" />
                    <button class="btn" type="submit">submit</button>
                </fieldset>
            </form>
        </div>
    </div>

    <div class="row-fluid">
        <div class="span4">
            <form id="form21">
                <fieldset>
                    <p>&emsp;<label for="nickname">账户名：</label>
                        <input type="text" id="nickname" class="input" name="nickname" size="20" placeholder="5-20个单词字符" required pattern="^\w+$" data-min="5" data-max="20" />
                    </p>
                    <p>登录密码：<input type="password" id="pwd" class="input" name="password" size="20" required data-min="6" data-max="20" /> 6-20个字符</p>
                    <p>确认密码：<input type="password" id="pwdChk" class="input" size="20" disabled required data-min="6" data-max="20" /></p>
                    <p>&emsp;<label for="verifycode">验证码：</label>
                        <input type="text" id="verifycode" class="input vt" name="code" size="6" required pattern="^\d{5}$" autocomplete="off" />
                        <a href="javascript:" id="codeChange">
                            <img src="/php/code.php?action=verifycode" border="0">点击换一张
                        </a>
                    </p>
                    <p><input type="submit" class="button" value="发表点评，请放心点击" /></p>
                    <input type="hidden" id="flagSubmit" name="flag" autocomplete="off">
                </fieldset>
            </form>
        </div>
        <div class="span4">
            <form  id="form22">
                <fieldset>
                </fieldset>
            </form>
        </div>
        <div class="span4">
            <form  id="form23">
                <fieldset>
                </fieldset>
            </form>
        </div>
    </div>

</div>

</body>

<script type="javascript">

    // 昵称的placeholder效果
    $("#nickname").bind("blur", function() {
        var self = this;
        setTimeout(function() {
            if ($.testRemind.display == false && $.html5Validate.isRegex(self) && self.value.length == 5) {
                $(self).testRemind("该昵称已存在");
            }
        }, 200);
    }).placeholder({
        labelMode: true
    });

    // 验证码刷新
    var codeChange = $("#codeChange");
    codeChange.bind("click", function() {
        var img = $(this).find("img");
        img.attr("src", img.attr("src").split("&")[0] + "&r=" + Math.random())
        return false;
    });

    // 登录密码与确认密码的交互
    var pwd = $("#pwd"), pwdChk = $("#pwdChk");
    pwd.bind("keyup", function() {
        if ($.html5Validate.isEmpty(this)) {
            pwdChk.attr("disabled", "disabled");
        } else {
            pwdChk.removeAttr("disabled");
        }
    });


    $("form").html5Validate(function() {
        var self = this;
        // 前后密码一致的验证
        if (pwd.val() !== pwdChk.val()) {
            pwdChk.testRemind("前后密码不一致").get(0).select();
        } else {
            $.ajax({
                url: this.action,
                type: this.method || "post",
                data: $(this).serialize(),
                dataType: "json",
                success: function(json) {
                    if (json.succ) {
                        $("#flagSubmit").val("true");
                        self.submit();
                        $(".button").attr("disabled", "disabled");
                    } else if (json.msg) {
                        alert(json.msg);
                        codeChange.trigger("click");
                    }
                },
                error: function() {
                    alert("网络原因，发表点评没有成功，您可以稍后重试！");
                }
            });
        }
    });

</script>

</html>
