select       T.schoolroll_id,
                T.invoice_id,
                S.name AS "stuName",
                R.student_no as "schoolrollNo",
                MAX(case T.typeid when '0a1eec7fa7444856984be054c485cfd3' then T.account else 0 end) 'xuefenfei',
                MAX(case T.typeid when '1e98bfd9adbd41bea509c987887017e2' then T.account else 0 end) 'kaoshifei',
                T.payment_amount
from (
        select 
                O.schoolroll_id,
                I.id invoice_id,
                I.payment_amount payment_amount,
                sum(pay_account) account 
        from finance_invoice_order IO 
        left join finance_invoice I on IO.invoice_id = I.id 
        left join finance_order O on IO.order_id = O.id 
        group by O.pay_type_id,O.schoolroll_id) T
left join roll_schoolroll R on T.schoolroll_id = R.id
left join roll_stu_base S on R.stu_base_id = S.id
group by  T.schoolroll_id