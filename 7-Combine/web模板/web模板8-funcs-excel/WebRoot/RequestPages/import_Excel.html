<!DOCTYPE html>
<html>
  <head>
    <title>import_Excel.html</title>
	
    <meta name="keywords" content="keyword1,keyword2,keyword3">
    <meta name="description" content="this is my page">
    <meta name="content-type" content="text/html; charset=UTF-8"><!-- 仅仅是标示信息 -->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><!-- 不仅是标示，还会产生效果 -->
    
    <!--<link rel="stylesheet" type="text/css" href="./styles.css">-->
	    <!-- BEGIN GLOBAL MANDATORY STYLES -->
		<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all" rel="stylesheet" type="text/css" />
		<link href="../Modules/Library/metronic-4.7/assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
		<link href="../Modules/Library/metronic-4.7/assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
		<!-- END GLOBAL MANDATORY STYLES -->
		<link href="../Modules/Library/metronic-4.7/assets/global/plugins/jstree/dist/themes/default/style.min.css" rel="stylesheet" type="text/css" />
		<link href="../Modules/Library/metronic-4.7/assets/global/plugins/datatables/datatables.min.css" rel="stylesheet" type="text/css" />
		<link href="../Modules/Library/metronic-4.7/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css" rel="stylesheet" type="text/css" />

		<!-- 遮罩层所需CSS -->
		<link href="../Modules/Library/metronic-4.7/assets/global/plugins/bootstrap-modal/css/bootstrap-modal-bs3patch.css" rel="stylesheet" type="text/css" />
        <link href="../Modules/Library/metronic-4.7/assets/global/plugins/bootstrap-modal/css/bootstrap-modal.css" rel="stylesheet" type="text/css" />

		<link href="../Modules/Library/metronic-4.7/assets/global/plugins/bootstrap-fileinput/bootstrap-fileinput.css" rel="stylesheet" type="text/css" />
		<!-- BEGIN THEME GLOBAL STYLES -->
		<link href="../Modules/Library/metronic-4.7/assets/global/css/components.min.css" rel="stylesheet" id="style_components" type="text/css" />
		<link href="../Modules/Library/metronic-4.7/assets/global/css/plugins.min.css" rel="stylesheet" type="text/css" />
		<!-- END THEME GLOBAL STYLES -->
		<!-- BEGIN THEME LAYOUT STYLES -->
		<link href="../Modules/Library/metronic-4.7/assets/layouts/layout/css/layout.min.css" rel="stylesheet" type="text/css" />
		
		<link href="../Modules/Library/metronic-4.7/assets/global/plugins/bootstrap-select/css/bootstrap-select.min.css" rel="stylesheet" type="text/css" />
		<!-- 弹出框 -->
		<link href="../Modules/Library/sweetalert/css/sweetalert.css" rel="stylesheet" type="text/css" />
	<!-- END THEME LAYOUT STYLES -->

  </head>
  
  <body>
    <h2>导入excel的测试页面 </h2>
    
    <button class='btn green' type="button" style='float:left;margin-left:15px;'  data-toggle="modal" onclick ="showImportModal();">导入发票</button>
    
    <!-- 导入模态框 -->
	<div id="importModal" class="modal fade" role="dialog" aria-hidden="true" style="height:800px">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
					<h4 class="modal-title">批量上传</h4>
				</div>
				<div class="modal-body form">
					<form id="importForm" action="#" class="form-horizontal form-row-seperated" enctype="multipart/form-data">
						<div class="form-group">
							<label class="col-sm-3 control-label">下载模板：</label>
							<button class='btn green' type="button" style='float:left;margin-left:15px;' onclick="downloadTemplate()">下载</button>
						</div>
						<div class="form-group">
							<label class="col-sm-3 control-label">上传文件：</label>
							<div class="col-md-4" id="importFile">
                                  <div class="fileinput fileinput-new" data-provides="fileinput">
                                      <span class="btn green btn-file">
                                          <span class="fileinput-new"> 选择导入文件 </span>
                                          <span class="fileinput-exists"> 更换 </span>
                                          <input type="file" name="file" id="importInvoiceFile" accept="application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" class="required" > </span>
                                      <span class="fileinput-filename"> </span> &nbsp;
                                      <a href="javascript:;" class="close fileinput-exists" data-dismiss="fileinput"> </a>
                                  </div>
                             </div>
						</div>
					</form>	
					<form id="downloadTemplateForm" method="POST" style="display:none"></form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn grey-salsa btn-outline" data-dismiss="modal">关闭</button>
					<button type="button" class="btn green ajaxButton" onclick="uploadInvoiceFile()">上传</button>
				</div>
			</div>
		</div>
	</div>
	
  </body>
  
  	<!-- BEGIN CORE PLUGINS -->
	<script src="../Modules/Library/metronic-4.7/assets/global/plugins/jquery.min.js" type="text/javascript"></script>
	<script src="../Modules/Library/metronic-4.7/assets/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
	<!-- END CORE PLUGINS -->
	<script src="../Modules/Library/metronic-4.7/assets/global/plugins/bootstrap-select/js/bootstrap-select.min.js" type="text/javascript"></script>
	<!-- BEGIN PAGE LEVEL PLUGINS -->
	<script src="../Modules/Library/metronic-4.7/assets/global/plugins/moment.min.js" type="text/javascript"></script>
	<script src="../Modules/Library/metronic-4.7/assets/global/scripts/app.min.js" type="text/javascript"></script>
	<script src="../Modules/Library/metronic-4.7/assets/global/plugins/morris/morris.min.js" type="text/javascript"></script>
	<script src="../Modules/Library/metronic-4.7/assets/global/plugins/morris/raphael-min.js" type="text/javascript"></script>
	<!-- END PAGE LEVEL PLUGINS -->
	<script src="../Modules/Library/metronic-4.7/assets/global/plugins/bootstrap-fileinput/bootstrap-fileinput.js" type="text/javascript"></script>
	<script src="../Modules/Library/metronic-4.7/assets/global/plugins/datatables/datatables.min.js" type="text/javascript"></script>
	<script src="../Modules/Library/metronic-4.7/assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.js" type="text/javascript"></script>
	<script src="../Modules/Library/metronic-4.7/assets/global/plugins/jstree/dist/jstree.min.js" type="text/javascript"></script>

	<script src="../Modules/Library/metronic-4.7/assets/pages/scripts/components-bootstrap-select.min.js" type="text/javascript"></script>
	
  
  
  <script type="text/javascript">
  
  //显示导入模态框
  function showImportModal(){
  	$("#importModal").modal('show');
  }
  
//下载导入模板
  function downloadTemplate(){
  	var url = encodeURI( "manage/invoice/downloadImportInvoiceTemplate.do?fileName=invoiceImportTemplate.xlsx");
  	$("#downloadTemplateForm").attr('action',url);
  	$("#downloadTemplateForm").attr('target','');
  	$("#downloadTemplateForm").submit();
  }

  </script>

</html>
